Hardiness_analysis_stan_readme

These stan files are dfferent attempts to model cold hardiness in winegrapes using data provided by Carl from AG Canada. 

Dose Response Models
------------------------

These models are all variants on a sigmoidal model. Some stan files are for testing priors and some are for running analyses

doseResponse2priorCheck.stan  
This is the prior check of the reparameterised drc suggested on Discourse https://discourse.mc-stan.org/t/dose-response-model-with-partial-pooling-on-maximum-value/17086/6.  

doseResponsePar2.stan
This is the actual model of the reparameterised drc suggested on Discourse https://discourse.mc-stan.org/t/dose-response-model-with-partial-pooling-on-maximum-value/17086/6.  

doseResponsedVar.stan
This is the "normal" parameterisation of the drc, but with hierarchical variety level variation on the d variable, and centred parameterisation. It doesnt quite work - there are some fitting issues. Instead use ncp.  

doseResponsedVar_ncp.stan
This is the "normal" parameterisation of the drc, but with hierarchical variety level variation on the d variable, and non centred parameterisation. It works. 

doseResponse_priorCheck.stan
This is the PRIOR CHECK for the "normal" parameterisation of the drc and no hierarchical elements. 

doseResponse_priorCheck1.stan
This is also the PRIOR CHECK for the "normal" parameterisation of the drc and no hierarchical elements. It contains some old priors I tried, and is not to be used. Use doseResponse_priorCheck.stan instead.  

doseResponse_priorCheck_vars.stan
This is the PRIOR CHECK for the "normal" parameterisation of the drc, but with hierarchical variety level variation on the d variable, and centred parameterisation. 

doseResponseSimple.stan
This is the model of the normal drc model. e is a parameter, and ehat is transformed. It doesnt work. ise doseResponseSimple2.stan 

doseResponseSimple2.stan
This is the model of the normal drc model. ehat is a parameter, rather than e. It works. 

doseResponseSimple2_oldPriors.stan
Same structure as doseResponseSimple2.stan, but with old less good priors 

doseResponsedVarSite_ncp.stan
A non centred parameterisation model dose response curve where there is a hierarchical element to d for both variety and site

doseResponseDBVarSite_ncp.stan
Non centered hierarchical for site and variety maximum vbalue, and variety slope. 

doseResponse_priorCheck_varsSitesDB.stan
checking priors for doseResponseDBVarSite_ncp.stan. Non centered hierarchical for site and variety maximum vbalue, and variety slope. 

doseResponseDBVarSite_ncp_predict.stan
teh same as doseResponseDBVarSite_ncp.stan, in that is has ncp hierarchical for variety and site for max hadriness (d) and slope (b) has variety effect. Thsiu model though takes an extra set of x values and predicts hardiness. I used Washington state hardiness for this. 

Linear Models
---------------------------

These models are all based on a normal linear model of hardiness againt temp, with varying amounts of hierarchical elements

noncentred_slope_varietySimple.stan

nonCentre_slopeSiteVarietyCov.stan

nonCentre_slopeVariety_beta.stan

nonCentre_slopeVarietyCov.stan

quad_nonCentre_slopeVarietyCov.stan

quad_slopeVarietyCov.stan

slope_nonCentre.stan

slopeVarietyCov.stan

slope_varietySimple.stan
